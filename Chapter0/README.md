# JSP/Servletとはなにか

- ## 静的Webページと動的Webページ
    ホームページは基本的にHTMLで記述されている。
    ただ、原理的にHTMLはマークアップ言語で、ホームページの構造を記述することはできるものの、Web上で動くアプリを作ることはできない。
    
    動きのないWebページのものを静的Webページという。
    メールの受信ができたり、電車やバスを利用する際の乗り換え地点や移動にかかる時間を調べられたりと、あたかもアプリケーションのような働きをしている。

    このようなWebページのことを、動きのあるWebページということで、動的Webページと呼ぶ。
    JSPとサーブレットは、HTMLにJavaを組み込むことにより、動的Webページを生成することができる。

    1.静的なWebページの仕組み
    ```
        +--------+                              +---------------+
        |        |---(A)----- Request  -------->|               |
        | Client |                              |  Web Server   |
        |        |<--(B)----- Response ---------|               |
        +--------+                              +---------------+
    
        (A):スマホやパソコンとか
        (B):HTMLとか
    ```


- ## 動的Webページの仕組み
    通常、Webページはインターネットを介してWebサーバーにWebページの要求（リクエスト）を送る。
    すると、それを受け取ったWebブラウザは、その内容を表示する。

    これに対し、動的Webページは、リクエストがWebサーバーに送られるまでは同じだが、そのリクエストをもとにサーバー上でアプリが起動し、データベースへのアクセスといった処理を行い、結果をHTMLという形でレスポンスする。

    つまり動的なWebページでは、ページを操作しているユーザーの条件次第でサーバーがその条件に合った処理を行い、その処理結果をもとに生成されたWebページが表示される。
    そのため、ユーザーの指定する条件により内容が変わる点が静的なWebページと大きく異なる。

    2.動的なWebページの仕組み
    ```
        +--------+                          +---------------+           
        |        |---(A)--- Request  ------>|               |             +---------------+
        | Client |                          |  Web Server   |<----(C)---->|   database    |
        |        |<--(B)--- Response -------|               |             +---------------+
        +--------+                          +---------------+
    
        (A):スマホやパソコンとかが画面を見せろと要求
        (B):HTMLとかを送信
        (C):データベースで操作したり、値を返したりとかする

        Web Server:(A)のリクエストに応じHTML生成
    ```
    

- ## JSP/Servletの仕組み
    - 一週間で身につくJSP/Servlet <br>
    [http://web.sevendays-study.com/JSPServlet/day0.html]<br>
    
    JSPとはJavaServerPagesの略で、Java言語を利用してアプリケーションサーバーで動的なWebページを生成し、利用者側に送信し表示させる技術。
    HTMLファイルの中に、Javaのコードを埋め込んでJavaの処理が可能になる仕組みがJSP。

    Javaの実行した処理結果をHTMLとして出力するさせることができ、クライアント側（ユーザー）のリクエスト（要求）に応じた動的なWebページを生成しレスポンス（応答）することが可能になる。

    それに対して、サーブレットとは、Web上で実行されるJavaプログラムのこと。
    このJSPとサーブレットの組み合わせによりWebアプリが構成されている。
    また、JSPを実行するには、Webサーバーとは別に、アプリケーションサーバーと呼ばれるサーバーが必要。
    これは、アプリケーションソフトウェアを実行するサーバーコンピュータやクライアント側とサーバー側の中間に入るソフトウェアのことを指す。
    Webサーバーと連携することにより、Web上でアプリを動作させることを可能にしている。

    - 【初心者向け】サーブレットとJSPの違いをわかりやすく解説！<br>
    [https://ryonotes.com/difference-between-servlet-and-jsp/]<br>
    ```
                                           Presentation             Business              Integration            Database
        Client                                 Layer                  Layer                  Layer                 Layer
                                         +-Web Container-+        +---------------+     +---------------+     +---------------+ 
                                         | Controller    |        | +--------------Model---------------+|     |               |
        +-------------+                  |  +----------+ |        | | +---------+ |     | +----------+ ||     |  +----------+ |
        |   Request   |---- Request  --->|  |  Servlet |<------------>| Business|<---+--->|Connection|<---+----->| Database | |
        |    Page     |                  |  +----|-----+ |        | | |  Logic  | |  |  | |  Manager | || |   |  +----------+ |
        +-------------+                  |       |       |        | | +---------+ |  |  | +----------+ || |   |               |
                                         | View  ↓       |        | |             |  |  | +----------+ || |   |               |
        +-------------+                  |  +----------+ |        | |             |  +--->|    DAO   |<---+   |               |
        |    Result   |<--- Response ----|  |    JSP   | |        | |             |     | +----------+ ||     |               |
        |    Page     |                  |  +----------+ |        | +----------------------------------+|     |               |
        +-------------+                  +---------------+        +---------------+     +---------------+     +---------------+
    ```
    サーブレットは、Webサーバー内のプレゼンテーション層における、Controllerの役割をしている。
    一方、JSPは、Webアプリケーションのプレゼンテーション層における、Viewの役割をしている。
    
    比較
    似ている点
    - その名前の機能をしたファイルである。
        サーブレットもJSPも機能自体、あるいはその機能を持つファイルのことを指す。

    - 同じWebコンテナ内で作動する。
        サーブレットもJSPもWebサーバー内のWebコンテナでコンパイルされ実行される。
        Webコンテナは、サーブレットやJSPの実行環境のこと。

    違う点
    - ファイルの拡張子が異なる。
        サーブレットは.javaの拡張子なのに対し、JSPは.jspの拡張子。

    - Webサーバ内における役割が異なる。
        サーブレットは、MVCモデルにおけるController。
        ブラウザからのリクエストに対して、処理を業務ロジックから呼び出したり、処理結果をJSPに渡したりする。
        一方JSPは、MVCモデルにおけるView。
        渡された処理結果の表示画面をブラウザへ渡す。

    - プログラムの書き方が異なる。
        サーブレットはJavaにより記述される。
        一方JSPは、主にHTMLを用いて記述される。

- ## JavaScriptとの違い
    ホームページ上で動く処理を行うのであれば、JavaScriptを利用することもできる。
    しかし、この2つはどのように違うのだろうか？
    JaaScriptは、Webサーバーから送信されるHTMLファイルの中に記述されており、実行はWebブラウザ上で行われる。
    つまり、クライアント側で動作するのがJavaScript。

    それに対し、JSP/Servletは、Webサーバー側でJavaのコードが実行され、その実行結果の内容がHTMLとしてクライアント側に送信されブラウザ上に表示される。

    また、JavaScriptは、ブラウザ上でソースを見ることが可能。
    しかし、JSPの場合はWebサーバー側で処理が行われその処理結果の内容だけが送信されるためブラウザ上でソースを見ることができない。
    そのため、ユーザーにどういった処理をしているか知られることがない。

- ## Apache Tomcat
    そして、JSP/Servletで用いられるこのアプリケーションサーバーが、Apache Tomcat。
    これは、WebサーバーであるApacheにアプリケーションサーバーを組み合わせたもので、Javaのアプリケーションサーバーは他の種類も存在するが、現在最も広く普及しているもの。

    通常、JSP/Servletを実際の運用に近い形で行おうとすると、ネットで接続された「クライアントのコンピュータ」と「サーバーのコンピュータ」の準備が必要となる。
    その負担を軽減し、1台のパソコンでネットワーク構築を実現させるためにTomcatが必要になる。

    ```
        +------------+             +------------+
        |   Apache   |             |   Tomcat   |
        | Web Server |<----------->| Application|<----------->Database
        |            |             |            |
        +------------+             +------------+

            HTML <-------------------- JSP, Servlet
    ```

- ## ローカル環境での開発
    Tomcatは開発環境としてローカルな環境にWebサーバーおよびアプリケーションサーバーを構築し、ネットワークを介することなくWebアプリ開発を可能にする。

    これにより、PCを複数台用意する必要がなく1台のPC上で、プログラムを作成→JSPを実行→ブラウザでの確認といった一連の動作が行えるようになる。

    IDE（統合開発環境）であるEclipseでは、それらを容易に操作する環境を用意している。
    Eclipseを使うことを前提として、JSP/Servletの学習を進めていく。